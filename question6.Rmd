---
title: "question6"
output: html_document  
date: "June 25, 2019"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
  
  ***  
  本文基于HiCnv查找copy number variation  
  
  ***
#### HiCnv call CNV  
  
(1) **修改并运行run_1DReadCoverage.pl 产生可执行的.sh文件：**  

`perl /lustre/user/liclab/pengt/projects/tools/HiCnv-master/Read_coverage_generation/run_1DReadCoverage.pl`   

(2) **产生实验对应的restriction fragment file :**  

`perl /lustre/user/liclab/pengt/projects/tools/HiCnv-master/scripts/F_GC_MAP_Files/create_F_GC_MAP_file.pl` 
  
(3) **运行第一步产生的可执行文件得到\~.perREfragStats和\~.F_GC_MAP.bed files:**  

`bash ~.sh` 
  
(4) **产生可执行的.sh文件:**  

`perl /lustre/user/liclab/pengt/projects/tools/HiCnv-master/CNV_calling/run_HiCnv.pl`  

(5) **运行上一步产生的可执行文件进行CNV calling:**  

`bash ~.sh`  
  
(6)  **Plot:**    

`col_ind <- ifelse( cnv_data[,3]<=2.1 & cnv_data[,3]>=1.9, 'green', ifelse(cnv_data[,3] > 2.1, 'red', 'blue') )`  
`chr_start <- 1`  
`chr_end <- sum( cnv_data[,1] == 1)`  
`plot(cnv_data[cnv_data[,1] == 1, 3] , pch = 16, col = col_ind[chr_start:chr_end],`  
     `xlim = c(0, dim(cnv_data)[1]),  ylim = c(0, 6),cex =,xaxt="n",xlab='chromosome',ylab='T5534'`  
     `)`  
`points( x = chr_start:chr_end , y = CNV_data[CNV_data[,1] == 1, 2], pch = '.', col = col_cn_ind[CNV_data[,1] == 1] )`  
`axis( side = 1, at = (chr_start + chr_end)/2, labels = 'Chr 1', line=0, col.axis = col_axis[1])`  
`col_axis <- rep(c('black'),11)`  
`names(col_axis) <- c(3,5,7,9,11,13,15,17,19,21,'X')`  
`for( i in c(2:22,'X')) {`  
   `if(sum( cnv_data[,1] == i) != 0) {`  
       `chr_start <- chr_end + 1`  
      `chr_end <- chr_end + sum( cnv_data[,1] == i)`  
      `points( x = chr_start:chr_end , y = cnv_data[cnv_data[,1] == i, 3] , pch =20,col = col_ind[cnv_data[,1] == i])`  
      `points( x = chr_start:chr_end , y = CNV_data[CNV_data[,1] == i, 2], pch = '.', col = col_cn_ind[CNV_data[,1] == i] )`  
      `if( is.element(i, c(seq(3, 21, 2), "X") ) ) {`  
        `axis( side = 1, at = (chr_start + chr_end)/2, labels = i, line=0, col.axis = col_axis[i] )`  
      `}`  
      
   `}`  
`}`  
  
  ***
  
#### Results  

(1) **5534T**  
  ![](5534T.png)  
(2) **A549**   
  ![](A549.png)  
  
  
